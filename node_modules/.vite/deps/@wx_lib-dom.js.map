{
  "version": 3,
  "sources": ["../../@wx/lib-dom/src/locate.ts", "../../@wx/lib-dom/src/delegateClick.ts", "../../@wx/lib-dom/src/clickOutside.ts", "../../@wx/lib-dom/src/uid.ts", "../../@wx/lib-dom/src/dates.ts", "../../@wx/lib-dom/src/locale.ts"],
  "sourcesContent": ["export function locate(el: Element | Event, attr = \"data-id\"): HTMLElement {\n\tlet node = el as HTMLElement;\n\tif (!node.tagName && (el as Event).target)\n\t\tnode = (el as Event).target as HTMLElement;\n\n\twhile (node) {\n\t\tif (node.getAttribute) {\n\t\t\tconst id = node.getAttribute(attr);\n\t\t\tif (id) return node;\n\t\t}\n\n\t\tnode = node.parentNode as HTMLElement;\n\t}\n\n\treturn null;\n}\nexport function locateAttr(el: Element | Event, attr = \"data-id\"): string {\n\tconst node = locate(el, attr);\n\tif (node) return node.getAttribute(attr);\n\n\treturn null;\n}\nexport function locateID(\n\tel: Element | Event,\n\tattr = \"data-id\"\n): string | number {\n\tconst node = locate(el, attr);\n\n\tif (node) {\n\t\treturn id(node.getAttribute(attr));\n\t}\n\n\treturn null;\n}\n\nexport function locateNode(el: Element, node: Element): boolean {\n\tlet n = el;\n\twhile (n) {\n\t\tif (n === node) {\n\t\t\treturn true;\n\t\t}\n\t\tn = n?.parentNode as Element;\n\t}\n\n\treturn null;\n}\n\nexport function id(value: string | number): string | number {\n\tif (typeof value === \"string\") {\n\t\tconst t = (value as undefined as number) * 1;\n\t\tif (!isNaN(t)) return t;\n\t}\n\n\treturn value;\n}\n", "import { locate, id as parseId } from \"./locate\";\n\nexport type IHandlersHash = { [key: string]: CallableFunction };\n\nexport function delegateEvent(\n\tnode: HTMLElement,\n\thandlers: IHandlersHash | CallableFunction,\n\tevent: string\n) {\n\tfunction handleEvent(ev: Event) {\n\t\tconst node = locate(ev);\n\t\tif (!node) return;\n\t\tconst id = parseId(node.dataset.id);\n\n\t\tif (typeof handlers === \"function\") return handlers(id, ev);\n\n\t\tlet action;\n\t\tlet test = ev.target as HTMLElement;\n\t\twhile (test != node) {\n\t\t\taction = test.dataset ? test.dataset.action : null;\n\t\t\tif (action) {\n\t\t\t\tif (handlers[action]) {\n\t\t\t\t\thandlers[action](id, ev);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\ttest = test.parentNode as HTMLElement;\n\t\t}\n\t\tif (handlers[event]) handlers[event](id, ev);\n\t}\n\tnode.addEventListener(event, handleEvent);\n}\n\nexport function delegateClick(node: HTMLElement, handlers: IHandlersHash) {\n\tdelegateEvent(node, handlers, \"click\");\n\tif (handlers.dblclick) delegateEvent(node, handlers.dblclick, \"dblclick\");\n}\n", "export function clickOutside(node: HTMLElement, callback: CallableFunction) {\n\tconst events = [\"click\", \"contextmenu\"];\n\tconst handleClick: EventListener = (event: Event) => {\n\t\tif (\n\t\t\tnode &&\n\t\t\t!node.contains(event.target as Node) &&\n\t\t\t!event.defaultPrevented\n\t\t) {\n\t\t\tcallback(event);\n\t\t}\n\t};\n\n\tevents.forEach(e => document.addEventListener(e, handleClick, true));\n\treturn {\n\t\tdestroy() {\n\t\t\tevents.forEach(e => document.removeEventListener(e, handleClick, true));\n\t\t},\n\t};\n}\n", "let id = new Date().valueOf();\n\nexport function uid(): number {\n\tid += 1;\n\treturn id;\n}\n", "export interface ILocale {\n\tdayShort: string[];\n\tdayFull: string[];\n\tmonthShort: string[];\n\tmonthFull: string[];\n\n\tam?: string[];\n\tpm?: string[];\n}\n\nfunction toFixed(num: number): string {\n\tif (num < 10) return \"0\" + num;\n\treturn num.toString();\n}\nfunction toFixedMs(num: number): string {\n\tconst temp = toFixed(num);\n\treturn temp.length == 2 ? \"0\" + temp : temp;\n}\n\nexport function getDuodecade(year: number): { start: number; end: number } {\n\tconst start = Math.floor(year / 11) * 11;\n\treturn {\n\t\tstart,\n\t\tend: start + 11,\n\t};\n}\n\nfunction getISOWeek(ndate: Date): number {\n\tlet nday = ndate.getDay();\n\tif (nday === 0) {\n\t\tnday = 7;\n\t}\n\tconst first_thursday = new Date(ndate.valueOf());\n\tfirst_thursday.setDate(ndate.getDate() + (4 - nday));\n\tconst year_number = first_thursday.getFullYear(); // year of the first Thursday\n\tconst ordinal_date = Math.floor(\n\t\t(first_thursday.getTime() - new Date(year_number, 0, 1).getTime()) /\n\t\t\t86400000\n\t); //ordinal date of the first Thursday - 1 (so not really ordinal date)\n\tconst weekNumber = 1 + Math.floor(ordinal_date / 7);\n\treturn weekNumber;\n}\n\nconst emptyAmPm = [\"\", \"\"];\nfunction date2str(mask: string, date: Date, locale: ILocale): number | string {\n\tswitch (mask) {\n\t\tcase \"%d\":\n\t\t\treturn toFixed(date.getDate());\n\t\tcase \"%m\":\n\t\t\treturn toFixed(date.getMonth() + 1);\n\t\tcase \"%j\":\n\t\t\treturn date.getDate();\n\t\tcase \"%n\":\n\t\t\treturn date.getMonth() + 1;\n\t\tcase \"%y\":\n\t\t\treturn toFixed(date.getFullYear() % 100);\n\t\tcase \"%Y\":\n\t\t\treturn date.getFullYear();\n\t\tcase \"%D\":\n\t\t\treturn locale.dayShort[date.getDay()];\n\t\tcase \"%l\":\n\t\t\treturn locale.dayFull[date.getDay()];\n\t\tcase \"%M\":\n\t\t\treturn locale.monthShort[date.getMonth()];\n\t\tcase \"%F\":\n\t\t\treturn locale.monthFull[date.getMonth()];\n\t\tcase \"%h\":\n\t\t\treturn toFixed(((date.getHours() + 11) % 12) + 1);\n\t\tcase \"%g\":\n\t\t\treturn ((date.getHours() + 11) % 12) + 1;\n\t\tcase \"%G\":\n\t\t\treturn date.getHours();\n\t\tcase \"%H\":\n\t\t\treturn toFixed(date.getHours());\n\t\tcase \"%i\":\n\t\t\treturn toFixed(date.getMinutes());\n\t\tcase \"%a\":\n\t\t\treturn ((date.getHours() > 11 ? locale.pm : locale.am) || emptyAmPm)[0];\n\t\tcase \"%A\":\n\t\t\treturn ((date.getHours() > 11 ? locale.pm : locale.am) || emptyAmPm)[1];\n\t\tcase \"%s\":\n\t\t\treturn toFixed(date.getSeconds());\n\t\tcase \"%S\":\n\t\t\treturn toFixedMs(date.getMilliseconds());\n\t\tcase \"%W\":\n\t\t\treturn toFixed(getISOWeek(date));\n\t\tcase \"%c\": {\n\t\t\tlet str = date.getFullYear() + \"\";\n\t\t\tstr += \"-\" + toFixed(date.getMonth() + 1);\n\t\t\tstr += \"-\" + toFixed(date.getDate());\n\t\t\tstr += \"T\";\n\t\t\tstr += toFixed(date.getHours());\n\t\t\tstr += \":\" + toFixed(date.getMinutes());\n\t\t\tstr += \":\" + toFixed(date.getSeconds());\n\t\t\treturn str;\n\t\t}\n\t\tdefault:\n\t\t\treturn mask;\n\t}\n}\n\nconst formatFlags = /%[a-zA-Z]/g;\n\nexport function dateToString(format: string, locale: ILocale) {\n\tif (typeof format == \"function\") return format;\n\n\treturn function (date: Date): string {\n\t\tif (!date) return \"\";\n\t\tif (!date.getMonth) date = new Date(date);\n\n\t\treturn format.replace(\n\t\t\tformatFlags,\n\t\t\ts => date2str(s, date, locale) as string\n\t\t);\n\t};\n}\n", "type Dictionary = (key: string) => string;\ntype IHash<T> = { [key: string]: T };\ntype Group<T> = IHash<IHash<T> | T>;\ntype Terms = Group<string>;\n\nexport interface ILocale {\n\tgetGroup(group: string): Dictionary;\n\tgetRaw(): Terms;\n\textend(values: Terms, optional: boolean): ILocale;\n}\n\nfunction isObject(a: string | IHash<string>) {\n\treturn a && typeof a === \"object\" && !Array.isArray(a);\n}\n\nfunction extend(a: Terms, b: Terms): Terms {\n\tfor (const key in b) {\n\t\tconst from = b[key];\n\t\tif (isObject(a[key]) && isObject(from)) {\n\t\t\ta[key] = extend(\n\t\t\t\t{ ...(a[key] as IHash<string>) },\n\t\t\t\tb[key] as IHash<string>\n\t\t\t) as IHash<string>;\n\t\t} else {\n\t\t\ta[key] = b[key];\n\t\t}\n\t}\n\n\treturn a;\n}\n\nexport function locale(words: Terms): ILocale {\n\treturn {\n\t\tgetGroup(group: string): Dictionary {\n\t\t\tconst block = words[group] as IHash<string>;\n\t\t\treturn (key: string) => {\n\t\t\t\treturn block ? block[key] || key : key;\n\t\t\t};\n\t\t},\n\t\tgetRaw(): Terms {\n\t\t\treturn words;\n\t\t},\n\t\textend(values: Terms, optional: boolean): ILocale {\n\t\t\tif (!values) return this;\n\n\t\t\tlet data: Terms;\n\t\t\tif (optional) {\n\t\t\t\tdata = extend({ ...values }, words);\n\t\t\t} else {\n\t\t\t\tdata = extend({ ...words }, values);\n\t\t\t}\n\n\t\t\treturn locale(data);\n\t\t},\n\t};\n}\n"],
  "mappings": "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",
  "names": ["id", "node", "parseId", "locale"]
}
